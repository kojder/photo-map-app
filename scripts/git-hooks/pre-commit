#!/bin/bash

# Pre-commit hook - runs all tests before allowing commit
# This hook is installed via scripts/install-hooks.sh

RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo ""
echo -e "${YELLOW}üß™ Running all tests before commit...${NC}"
echo ""

# Run test suite
./scripts/run-all-tests.sh

# Capture exit code
TEST_EXIT_CODE=$?

# If tests failed, abort commit
if [ $TEST_EXIT_CODE -ne 0 ]; then
    echo ""
    echo -e "${RED}‚ùå COMMIT ABORTED - Tests must pass before committing${NC}"
    echo ""
    echo "Fix the failing tests and try again."
    echo "To bypass this check (not recommended): git commit --no-verify"
    echo ""
    exit 1
fi

# Tests passed, allow commit
exit 0
