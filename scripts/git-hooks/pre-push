#!/bin/bash

# Pre-push hook - runs all tests before allowing push
# This hook is installed via scripts/install-hooks.sh

RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo ""
echo -e "${YELLOW}üß™ Running all tests before push...${NC}"
echo ""

# Run test suite
./scripts/run-all-tests.sh

# Capture exit code
TEST_EXIT_CODE=$?

# If tests failed, abort push
if [ $TEST_EXIT_CODE -ne 0 ]; then
    echo ""
    echo -e "${RED}‚ùå PUSH ABORTED - Tests must pass before pushing${NC}"
    echo ""
    echo "Fix the failing tests and try again."
    echo "To bypass this check (not recommended): git push --no-verify"
    echo ""
    exit 1
fi

# Tests passed, allow push
exit 0
